2024-11-16 20:48:33.641771: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1731790113.663407  366844 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1731790113.670085  366844 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-11-16 20:48:33.693335: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.










pygame 2.6.1 (SDL 2.28.4, Python 3.10.4)
Hello from the pygame community. https://www.pygame.org/contribute.html
Starting the training
<PIL.Image.Image image mode=RGB size=480x480 at 0x7F63F4DFBF70>
Directory created successfully: /opt/notebooks/shielding_files_20241116T204838_l0qq0zs8
Computing new shield
LOG: Starting with explicit model creation...
Elapsed time is 0.055481672286987305 seconds.
LOG: Starting with model checking...
Elapsed time is 0.0022592544555664062 seconds.
LOG: Starting to translate shield...
Elapsed time is 0.09865093231201172 seconds.
Directory created successfully: /opt/notebooks/shielding_files_20241116T204838_mvtpah60
Computing new shield
LOG: Starting with explicit model creation...
Elapsed time is 0.0499272346496582 seconds.
LOG: Starting with model checking...
Elapsed time is 0.0020194053649902344 seconds.
LOG: Starting to translate shield...
Elapsed time is 0.0931398868560791 seconds.
Directory created successfully: /opt/notebooks/shielding_files_20241116T204838_8_6xapnu
Computing new shield
LOG: Starting with explicit model creation...
Elapsed time is 0.0629734992980957 seconds.
LOG: Starting with model checking...
Elapsed time is 0.002311229705810547 seconds.
LOG: Starting to translate shield...
Elapsed time is 0.09321451187133789 seconds.
Directory created successfully: /opt/notebooks/shielding_files_20241116T204838_0szaws3x
Computing new shield
LOG: Starting with explicit model creation...
Elapsed time is 0.05124926567077637 seconds.
LOG: Starting with model checking...
Elapsed time is 0.0019919872283935547 seconds.
LOG: Starting to translate shield...
Elapsed time is 0.09357500076293945 seconds.
Directory created successfully: /opt/notebooks/shielding_files_20241116T204839_ah_hkhza
Computing new shield
LOG: Starting with explicit model creation...
Elapsed time is 0.05050516128540039 seconds.
LOG: Starting with model checking...
Elapsed time is 0.0020334720611572266 seconds.
LOG: Starting to translate shield...
Elapsed time is 0.09369325637817383 seconds.
Image saved as shield_overlay_image.png
The shield for shield_value = 0.0
Image saved as shield_overlay_image.png
The shield for shield_value = 0.9
Image saved as shield_overlay_image.png
The shield for shield_value = 0.99
Image saved as shield_overlay_image.png
The shield for shield_value = 0.999
Image saved as shield_overlay_image.png
The shield for shield_value = 1.0
Training with shield:
Image saved as shield_overlay_image.png
Using cpu device
Wrapping the env with a `Monitor` wrapper
Wrapping the env in a DummyVecEnv.
Wrapping the env in a VecTransposeImage.
-----------------------------------
| info/                |          |
|    no_shield_action  | 0        |
|    sum_opened_door   | 0        |
|    sum_picked_up     | 0        |
|    sum_ran_into_lava | 44       |
|    sum_reached_goal  | 5        |
| rollout/             |          |
|    ep_len_mean       | 40.5     |
|    ep_rew_mean       | -0.78    |
| time/                |          |
|    fps               | 147      |
|    iterations        | 1        |
|    time_elapsed      | 13       |
|    total_timesteps   | 2048     |
-----------------------------------
------------------------------------------
| info/                   |              |
|    no_shield_action     | 0            |
|    sum_opened_door      | 0            |
|    sum_picked_up        | 0            |
|    sum_ran_into_lava    | 81           |
|    sum_reached_goal     | 7            |
| rollout/                |              |
|    ep_len_mean          | 44.5         |
|    ep_rew_mean          | -0.822       |
| time/                   |              |
|    fps                  | 91           |
|    iterations           | 2            |
|    time_elapsed         | 44           |
|    total_timesteps      | 4096         |
| train/                  |              |
|    approx_kl            | 0.00709033   |
|    clip_fraction        | 0.0588       |
|    clip_range           | 0.2          |
|    entropy_loss         | -0.702       |
|    explained_variance   | -0.003182292 |
|    learning_rate        | 0.0003       |
|    loss                 | 0.0169       |
|    n_updates            | 10           |
|    policy_gradient_loss | -0.00787     |
|    value_loss           | 0.135        |
------------------------------------------
-----------------------------------------
| info/                   |             |
|    no_shield_action     | 0           |
|    sum_opened_door      | 0           |
|    sum_picked_up        | 0           |
|    sum_ran_into_lava    | 101         |
|    sum_reached_goal     | 13          |
| rollout/                |             |
|    ep_len_mean          | 53.9        |
|    ep_rew_mean          | -0.7        |
| time/                   |             |
|    fps                  | 84          |
|    iterations           | 3           |
|    time_elapsed         | 73          |
|    total_timesteps      | 6144        |
| train/                  |             |
|    approx_kl            | 0.014696596 |
|    clip_fraction        | 0.155       |
|    clip_range           | 0.2         |
|    entropy_loss         | -0.685      |
|    explained_variance   | 0.11010474  |
|    learning_rate        | 0.0003      |
|    loss                 | -0.00183    |
|    n_updates            | 20          |
|    policy_gradient_loss | -0.0243     |
|    value_loss           | 0.0625      |
-----------------------------------------
----------------------------------------
| info/                   |            |
|    no_shield_action     | 0          |
|    sum_opened_door      | 0          |
|    sum_picked_up        | 0          |
|    sum_ran_into_lava    | 111        |
|    sum_reached_goal     | 16         |
| rollout/                |            |
|    ep_len_mean          | 67.3       |
|    ep_rew_mean          | -0.61      |
| time/                   |            |
|    fps                  | 78         |
|    iterations           | 4          |
|    time_elapsed         | 104        |
|    total_timesteps      | 8192       |
| train/                  |            |
|    approx_kl            | 0.02456335 |
|    clip_fraction        | 0.259      |
|    clip_range           | 0.2        |
|    entropy_loss         | -0.659     |
|    explained_variance   | 0.37985063 |
|    learning_rate        | 0.0003     |
|    loss                 | -0.0504    |
|    n_updates            | 30         |
|    policy_gradient_loss | -0.0406    |
|    value_loss           | 0.0337     |
----------------------------------------
-----------------------------------------
| info/                   |             |
|    no_shield_action     | 0           |
|    sum_opened_door      | 0           |
|    sum_picked_up        | 0           |
|    sum_ran_into_lava    | 114         |
|    sum_reached_goal     | 20          |
| rollout/                |             |
|    ep_len_mean          | 80.3        |
|    ep_rew_mean          | -0.49       |
| time/                   |             |
|    fps                  | 76          |
|    iterations           | 5           |
|    time_elapsed         | 133         |
|    total_timesteps      | 10240       |
| train/                  |             |
|    approx_kl            | 0.026291579 |
|    clip_fraction        | 0.265       |
|    clip_range           | 0.2         |
|    entropy_loss         | -0.61       |
|    explained_variance   | 0.561914    |
|    learning_rate        | 0.0003      |
|    loss                 | -0.02       |
|    n_updates            | 40          |
|    policy_gradient_loss | -0.0388     |
|    value_loss           | 0.0167      |
-----------------------------------------
-----------------------------------------
| info/                   |             |
|    no_shield_action     | 0           |
|    sum_opened_door      | 0           |
|    sum_picked_up        | 0           |
|    sum_ran_into_lava    | 120         |
|    sum_reached_goal     | 28          |
| rollout/                |             |
|    ep_len_mean          | 90.1        |
|    ep_rew_mean          | -0.29       |
| time/                   |             |
|    fps                  | 75          |
|    iterations           | 6           |
|    time_elapsed         | 162         |
|    total_timesteps      | 12288       |
| train/                  |             |
|    approx_kl            | 0.019936511 |
|    clip_fraction        | 0.202       |
|    clip_range           | 0.2         |
|    entropy_loss         | -0.581      |
|    explained_variance   | 0.16192824  |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0361     |
|    n_updates            | 50          |
|    policy_gradient_loss | -0.0318     |
|    value_loss           | 0.0188      |
-----------------------------------------
-----------------------------------------
| info/                   |             |
|    no_shield_action     | 0           |
|    sum_opened_door      | 0           |
|    sum_picked_up        | 0           |
|    sum_ran_into_lava    | 127         |
|    sum_reached_goal     | 40          |
| rollout/                |             |
|    ep_len_mean          | 94.5        |
|    ep_rew_mean          | -0.06       |
| time/                   |             |
|    fps                  | 75          |
|    iterations           | 7           |
|    time_elapsed         | 190         |
|    total_timesteps      | 14336       |
| train/                  |             |
|    approx_kl            | 0.016564148 |
|    clip_fraction        | 0.165       |
|    clip_range           | 0.2         |
|    entropy_loss         | -0.583      |
|    explained_variance   | 0.6175076   |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0438     |
|    n_updates            | 60          |
|    policy_gradient_loss | -0.0326     |
|    value_loss           | 0.0149      |
-----------------------------------------
-----------------------------------------
| info/                   |             |
|    no_shield_action     | 0           |
|    sum_opened_door      | 0           |
|    sum_picked_up        | 0           |
|    sum_ran_into_lava    | 132         |
|    sum_reached_goal     | 48          |
| rollout/                |             |
|    ep_len_mean          | 99          |
|    ep_rew_mean          | 0.05        |
| time/                   |             |
|    fps                  | 74          |
|    iterations           | 8           |
|    time_elapsed         | 219         |
|    total_timesteps      | 16384       |
| train/                  |             |
|    approx_kl            | 0.022855077 |
|    clip_fraction        | 0.19        |
|    clip_range           | 0.2         |
|    entropy_loss         | -0.553      |
|    explained_variance   | 0.78353614  |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0397     |
|    n_updates            | 70          |
|    policy_gradient_loss | -0.0324     |
|    value_loss           | 0.0129      |
-----------------------------------------
-----------------------------------------
| info/                   |             |
|    no_shield_action     | 0           |
|    sum_opened_door      | 0           |
|    sum_picked_up        | 0           |
|    sum_ran_into_lava    | 135         |
|    sum_reached_goal     | 58          |
| rollout/                |             |
|    ep_len_mean          | 96          |
|    ep_rew_mean          | 0.17        |
| time/                   |             |
|    fps                  | 74          |
|    iterations           | 9           |
|    time_elapsed         | 247         |
|    total_timesteps      | 18432       |
| train/                  |             |
|    approx_kl            | 0.024973819 |
|    clip_fraction        | 0.217       |
|    clip_range           | 0.2         |
|    entropy_loss         | -0.549      |
|    explained_variance   | 0.61168593  |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0415     |
|    n_updates            | 80          |
|    policy_gradient_loss | -0.0323     |
|    value_loss           | 0.0115      |
-----------------------------------------
-----------------------------------------
| info/                   |             |
|    no_shield_action     | 0           |
|    sum_opened_door      | 0           |
|    sum_picked_up        | 0           |
|    sum_ran_into_lava    | 137         |
|    sum_reached_goal     | 62          |
| rollout/                |             |
|    ep_len_mean          | 99.7        |
|    ep_rew_mean          | 0.18        |
| time/                   |             |
|    fps                  | 74          |
|    iterations           | 10          |
|    time_elapsed         | 276         |
|    total_timesteps      | 20480       |
| train/                  |             |
|    approx_kl            | 0.022792688 |
|    clip_fraction        | 0.148       |
|    clip_range           | 0.2         |
|    entropy_loss         | -0.529      |
|    explained_variance   | 0.6628096   |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0146     |
|    n_updates            | 90          |
|    policy_gradient_loss | -0.0156     |
|    value_loss           | 0.00656     |
-----------------------------------------
Exception ignored in: <function MiniGridShieldHandler.__del__ at 0x7f63f93d49d0>
Traceback (most recent call last):
  File "/opt/notebooks/utils.py", line 94, in __del__
    shutil.rmtree(self.tmp_dir_name)
  File "/usr/lib/python3.10/shutil.py", line 712, in rmtree
    onerror(os.lstat, path, sys.exc_info())
  File "/usr/lib/python3.10/shutil.py", line 710, in rmtree
    orig_st = os.lstat(path)
FileNotFoundError: [Errno 2] No such file or directory: '/opt/notebooks/shielding_files_20241116T204838_mvtpah60'
Exception ignored in: <function MiniGridShieldHandler.__del__ at 0x7f63f93d49d0>
Traceback (most recent call last):
  File "/opt/notebooks/utils.py", line 94, in __del__
    shutil.rmtree(self.tmp_dir_name)
  File "/usr/lib/python3.10/shutil.py", line 712, in rmtree
    onerror(os.lstat, path, sys.exc_info())
  File "/usr/lib/python3.10/shutil.py", line 710, in rmtree
    orig_st = os.lstat(path)
FileNotFoundError: [Errno 2] No such file or directory: '/opt/notebooks/shielding_files_20241116T204838_8_6xapnu'
Exception ignored in: <function MiniGridShieldHandler.__del__ at 0x7f63f93d49d0>
Traceback (most recent call last):
  File "/opt/notebooks/utils.py", line 94, in __del__
    shutil.rmtree(self.tmp_dir_name)
  File "/usr/lib/python3.10/shutil.py", line 712, in rmtree
    onerror(os.lstat, path, sys.exc_info())
  File "/usr/lib/python3.10/shutil.py", line 710, in rmtree
    orig_st = os.lstat(path)
FileNotFoundError: [Errno 2] No such file or directory: '/opt/notebooks/shielding_files_20241116T204838_0szaws3x'
Exception ignored in: <function MiniGridShieldHandler.__del__ at 0x7f63f93d49d0>
Traceback (most recent call last):
  File "/opt/notebooks/utils.py", line 94, in __del__
    shutil.rmtree(self.tmp_dir_name)
  File "/usr/lib/python3.10/shutil.py", line 712, in rmtree
    onerror(os.lstat, path, sys.exc_info())
  File "/usr/lib/python3.10/shutil.py", line 710, in rmtree
    orig_st = os.lstat(path)
FileNotFoundError: [Errno 2] No such file or directory: '/opt/notebooks/shielding_files_20241116T204839_ah_hkhza'
Exception ignored in: <function MiniGridShieldHandler.__del__ at 0x7f63f93d49d0>
Traceback (most recent call last):
  File "/opt/notebooks/utils.py", line 94, in __del__
    shutil.rmtree(self.tmp_dir_name)
  File "/usr/lib/python3.10/shutil.py", line 712, in rmtree
    onerror(os.lstat, path, sys.exc_info())
  File "/usr/lib/python3.10/shutil.py", line 710, in rmtree
    orig_st = os.lstat(path)
FileNotFoundError: [Errno 2] No such file or directory: '/opt/notebooks/shielding_files_20241116T204838_l0qq0zs8'
