2024-11-16 20:57:50.651559: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1731790670.673118  371962 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1731790670.679856  371962 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-11-16 20:57:50.703549: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.










pygame 2.6.1 (SDL 2.28.4, Python 3.10.4)
Hello from the pygame community. https://www.pygame.org/contribute.html
Starting the training
<PIL.Image.Image image mode=RGB size=480x480 at 0x7FC3E2FF0400>
Directory created successfully: /opt/notebooks/shielding_files_20241116T205756_3wkad6bg
Computing new shield
LOG: Starting with explicit model creation...
Elapsed time is 0.052947282791137695 seconds.
LOG: Starting with model checking...
Elapsed time is 0.002238035202026367 seconds.
LOG: Starting to translate shield...
Elapsed time is 0.0993797779083252 seconds.
Directory created successfully: /opt/notebooks/shielding_files_20241116T205756_b1d63a5m
Computing new shield
LOG: Starting with explicit model creation...
Elapsed time is 0.05012702941894531 seconds.
LOG: Starting with model checking...
Elapsed time is 0.0020661354064941406 seconds.
LOG: Starting to translate shield...
Elapsed time is 0.0952916145324707 seconds.
Directory created successfully: /opt/notebooks/shielding_files_20241116T205756_l8u6fib0
Computing new shield
LOG: Starting with explicit model creation...
Elapsed time is 0.06325459480285645 seconds.
LOG: Starting with model checking...
Elapsed time is 0.0023157596588134766 seconds.
LOG: Starting to translate shield...
Elapsed time is 0.09523749351501465 seconds.
Directory created successfully: /opt/notebooks/shielding_files_20241116T205757_j11g9xe6
Computing new shield
LOG: Starting with explicit model creation...
Elapsed time is 0.0500791072845459 seconds.
LOG: Starting with model checking...
Elapsed time is 0.002017498016357422 seconds.
LOG: Starting to translate shield...
Elapsed time is 0.09501767158508301 seconds.
Directory created successfully: /opt/notebooks/shielding_files_20241116T205757_aem1roy1
Computing new shield
LOG: Starting with explicit model creation...
Elapsed time is 0.05028486251831055 seconds.
LOG: Starting with model checking...
Elapsed time is 0.002052783966064453 seconds.
LOG: Starting to translate shield...
Elapsed time is 0.09504413604736328 seconds.
Image saved as shield_overlay_image.png
The shield for shield_value = 0.0
Image saved as shield_overlay_image.png
The shield for shield_value = 0.9
Image saved as shield_overlay_image.png
The shield for shield_value = 0.99
Image saved as shield_overlay_image.png
The shield for shield_value = 0.999
Image saved as shield_overlay_image.png
The shield for shield_value = 1.0
Training with shield:
Image saved as shield_overlay_image.png
Using cpu device
Wrapping the env with a `Monitor` wrapper
Wrapping the env in a DummyVecEnv.
Wrapping the env in a VecTransposeImage.
-----------------------------------
| info/                |          |
|    no_shield_action  | 0        |
|    sum_opened_door   | 0        |
|    sum_picked_up     | 0        |
|    sum_ran_into_lava | 52       |
|    sum_reached_goal  | 6        |
| rollout/             |          |
|    ep_len_mean       | 33.3     |
|    ep_rew_mean       | -0.78    |
| time/                |          |
|    fps               | 129      |
|    iterations        | 1        |
|    time_elapsed      | 15       |
|    total_timesteps   | 2048     |
-----------------------------------
-------------------------------------------
| info/                   |               |
|    no_shield_action     | 0             |
|    sum_opened_door      | 0             |
|    sum_picked_up        | 0             |
|    sum_ran_into_lava    | 106           |
|    sum_reached_goal     | 10            |
| rollout/                |               |
|    ep_len_mean          | 33            |
|    ep_rew_mean          | -0.79         |
| time/                   |               |
|    fps                  | 88            |
|    iterations           | 2             |
|    time_elapsed         | 46            |
|    total_timesteps      | 4096          |
| train/                  |               |
|    approx_kl            | 0.009424098   |
|    clip_fraction        | 0.115         |
|    clip_range           | 0.2           |
|    entropy_loss         | -1.06         |
|    explained_variance   | -0.0009274483 |
|    learning_rate        | 0.0003        |
|    loss                 | -0.0114       |
|    n_updates            | 10            |
|    policy_gradient_loss | -0.0111       |
|    value_loss           | 0.0917        |
-------------------------------------------
-----------------------------------------
| info/                   |             |
|    no_shield_action     | 0           |
|    sum_opened_door      | 0           |
|    sum_picked_up        | 0           |
|    sum_ran_into_lava    | 140         |
|    sum_reached_goal     | 17          |
| rollout/                |             |
|    ep_len_mean          | 39          |
|    ep_rew_mean          | -0.77       |
| time/                   |             |
|    fps                  | 79          |
|    iterations           | 3           |
|    time_elapsed         | 76          |
|    total_timesteps      | 6144        |
| train/                  |             |
|    approx_kl            | 0.021542221 |
|    clip_fraction        | 0.2         |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.01       |
|    explained_variance   | 0.25136447  |
|    learning_rate        | 0.0003      |
|    loss                 | -0.018      |
|    n_updates            | 20          |
|    policy_gradient_loss | -0.0326     |
|    value_loss           | 0.0452      |
-----------------------------------------
----------------------------------------
| info/                   |            |
|    no_shield_action     | 0          |
|    sum_opened_door      | 0          |
|    sum_picked_up        | 0          |
|    sum_ran_into_lava    | 147        |
|    sum_reached_goal     | 26         |
| rollout/                |            |
|    ep_len_mean          | 51.9       |
|    ep_rew_mean          | -0.55      |
| time/                   |            |
|    fps                  | 76         |
|    iterations           | 4          |
|    time_elapsed         | 107        |
|    total_timesteps      | 8192       |
| train/                  |            |
|    approx_kl            | 0.03395064 |
|    clip_fraction        | 0.425      |
|    clip_range           | 0.2        |
|    entropy_loss         | -0.98      |
|    explained_variance   | 0.45510834 |
|    learning_rate        | 0.0003     |
|    loss                 | -0.0554    |
|    n_updates            | 30         |
|    policy_gradient_loss | -0.0616    |
|    value_loss           | 0.0454     |
----------------------------------------
-----------------------------------------
| info/                   |             |
|    no_shield_action     | 0           |
|    sum_opened_door      | 0           |
|    sum_picked_up        | 0           |
|    sum_ran_into_lava    | 152         |
|    sum_reached_goal     | 34          |
| rollout/                |             |
|    ep_len_mean          | 65.2        |
|    ep_rew_mean          | -0.38       |
| time/                   |             |
|    fps                  | 73          |
|    iterations           | 5           |
|    time_elapsed         | 138         |
|    total_timesteps      | 10240       |
| train/                  |             |
|    approx_kl            | 0.028397793 |
|    clip_fraction        | 0.33        |
|    clip_range           | 0.2         |
|    entropy_loss         | -0.887      |
|    explained_variance   | 0.592656    |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0482     |
|    n_updates            | 40          |
|    policy_gradient_loss | -0.0445     |
|    value_loss           | 0.0243      |
-----------------------------------------
-----------------------------------------
| info/                   |             |
|    no_shield_action     | 0           |
|    sum_opened_door      | 0           |
|    sum_picked_up        | 0           |
|    sum_ran_into_lava    | 152         |
|    sum_reached_goal     | 56          |
| rollout/                |             |
|    ep_len_mean          | 74          |
|    ep_rew_mean          | 0.07        |
| time/                   |             |
|    fps                  | 71          |
|    iterations           | 6           |
|    time_elapsed         | 171         |
|    total_timesteps      | 12288       |
| train/                  |             |
|    approx_kl            | 0.023465844 |
|    clip_fraction        | 0.254       |
|    clip_range           | 0.2         |
|    entropy_loss         | -0.85       |
|    explained_variance   | 0.73208344  |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0337     |
|    n_updates            | 50          |
|    policy_gradient_loss | -0.0335     |
|    value_loss           | 0.00697     |
-----------------------------------------
----------------------------------------
| info/                   |            |
|    no_shield_action     | 0          |
|    sum_opened_door      | 0          |
|    sum_picked_up        | 0          |
|    sum_ran_into_lava    | 152        |
|    sum_reached_goal     | 69         |
| rollout/                |            |
|    ep_len_mean          | 84.2       |
|    ep_rew_mean          | 0.36       |
| time/                   |            |
|    fps                  | 70         |
|    iterations           | 7          |
|    time_elapsed         | 202        |
|    total_timesteps      | 14336      |
| train/                  |            |
|    approx_kl            | 0.0281706  |
|    clip_fraction        | 0.217      |
|    clip_range           | 0.2        |
|    entropy_loss         | -0.793     |
|    explained_variance   | 0.91483295 |
|    learning_rate        | 0.0003     |
|    loss                 | -0.0404    |
|    n_updates            | 60         |
|    policy_gradient_loss | -0.0285    |
|    value_loss           | 0.00479    |
----------------------------------------
-----------------------------------------
| info/                   |             |
|    no_shield_action     | 0           |
|    sum_opened_door      | 0           |
|    sum_picked_up        | 0           |
|    sum_ran_into_lava    | 152         |
|    sum_reached_goal     | 93          |
| rollout/                |             |
|    ep_len_mean          | 80.7        |
|    ep_rew_mean          | 0.62        |
| time/                   |             |
|    fps                  | 70          |
|    iterations           | 8           |
|    time_elapsed         | 233         |
|    total_timesteps      | 16384       |
| train/                  |             |
|    approx_kl            | 0.020578759 |
|    clip_fraction        | 0.179       |
|    clip_range           | 0.2         |
|    entropy_loss         | -0.808      |
|    explained_variance   | 0.95971894  |
|    learning_rate        | 0.0003      |
|    loss                 | 0.0137      |
|    n_updates            | 70          |
|    policy_gradient_loss | -0.0231     |
|    value_loss           | 0.00207     |
-----------------------------------------
-----------------------------------------
| info/                   |             |
|    no_shield_action     | 0           |
|    sum_opened_door      | 0           |
|    sum_picked_up        | 0           |
|    sum_ran_into_lava    | 152         |
|    sum_reached_goal     | 118         |
| rollout/                |             |
|    ep_len_mean          | 72.7        |
|    ep_rew_mean          | 0.78        |
| time/                   |             |
|    fps                  | 69          |
|    iterations           | 9           |
|    time_elapsed         | 264         |
|    total_timesteps      | 18432       |
| train/                  |             |
|    approx_kl            | 0.021781888 |
|    clip_fraction        | 0.193       |
|    clip_range           | 0.2         |
|    entropy_loss         | -0.756      |
|    explained_variance   | 0.9674149   |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0467     |
|    n_updates            | 80          |
|    policy_gradient_loss | -0.0274     |
|    value_loss           | 0.00252     |
-----------------------------------------
-----------------------------------------
| info/                   |             |
|    no_shield_action     | 0           |
|    sum_opened_door      | 0           |
|    sum_picked_up        | 0           |
|    sum_ran_into_lava    | 153         |
|    sum_reached_goal     | 152         |
| rollout/                |             |
|    ep_len_mean          | 63.7        |
|    ep_rew_mean          | 0.84        |
| time/                   |             |
|    fps                  | 69          |
|    iterations           | 10          |
|    time_elapsed         | 294         |
|    total_timesteps      | 20480       |
| train/                  |             |
|    approx_kl            | 0.029367473 |
|    clip_fraction        | 0.295       |
|    clip_range           | 0.2         |
|    entropy_loss         | -0.754      |
|    explained_variance   | 0.9294639   |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0575     |
|    n_updates            | 90          |
|    policy_gradient_loss | -0.0467     |
|    value_loss           | 0.00604     |
-----------------------------------------
Exception ignored in: <function MiniGridShieldHandler.__del__ at 0x7fc3e75d0af0>
Traceback (most recent call last):
  File "/opt/notebooks/utils.py", line 94, in __del__
    shutil.rmtree(self.tmp_dir_name)
  File "/usr/lib/python3.10/shutil.py", line 712, in rmtree
    onerror(os.lstat, path, sys.exc_info())
  File "/usr/lib/python3.10/shutil.py", line 710, in rmtree
    orig_st = os.lstat(path)
FileNotFoundError: [Errno 2] No such file or directory: '/opt/notebooks/shielding_files_20241116T205756_b1d63a5m'
Exception ignored in: <function MiniGridShieldHandler.__del__ at 0x7fc3e75d0af0>
Traceback (most recent call last):
  File "/opt/notebooks/utils.py", line 94, in __del__
    shutil.rmtree(self.tmp_dir_name)
  File "/usr/lib/python3.10/shutil.py", line 712, in rmtree
    onerror(os.lstat, path, sys.exc_info())
  File "/usr/lib/python3.10/shutil.py", line 710, in rmtree
    orig_st = os.lstat(path)
FileNotFoundError: [Errno 2] No such file or directory: '/opt/notebooks/shielding_files_20241116T205756_l8u6fib0'
Exception ignored in: <function MiniGridShieldHandler.__del__ at 0x7fc3e75d0af0>
Traceback (most recent call last):
  File "/opt/notebooks/utils.py", line 94, in __del__
    shutil.rmtree(self.tmp_dir_name)
  File "/usr/lib/python3.10/shutil.py", line 712, in rmtree
    onerror(os.lstat, path, sys.exc_info())
  File "/usr/lib/python3.10/shutil.py", line 710, in rmtree
    orig_st = os.lstat(path)
FileNotFoundError: [Errno 2] No such file or directory: '/opt/notebooks/shielding_files_20241116T205757_j11g9xe6'
Exception ignored in: <function MiniGridShieldHandler.__del__ at 0x7fc3e75d0af0>
Traceback (most recent call last):
  File "/opt/notebooks/utils.py", line 94, in __del__
    shutil.rmtree(self.tmp_dir_name)
  File "/usr/lib/python3.10/shutil.py", line 712, in rmtree
    onerror(os.lstat, path, sys.exc_info())
  File "/usr/lib/python3.10/shutil.py", line 710, in rmtree
    orig_st = os.lstat(path)
FileNotFoundError: [Errno 2] No such file or directory: '/opt/notebooks/shielding_files_20241116T205757_aem1roy1'
Exception ignored in: <function MiniGridShieldHandler.__del__ at 0x7fc3e75d0af0>
Traceback (most recent call last):
  File "/opt/notebooks/utils.py", line 94, in __del__
    shutil.rmtree(self.tmp_dir_name)
  File "/usr/lib/python3.10/shutil.py", line 712, in rmtree
    onerror(os.lstat, path, sys.exc_info())
  File "/usr/lib/python3.10/shutil.py", line 710, in rmtree
    orig_st = os.lstat(path)
FileNotFoundError: [Errno 2] No such file or directory: '/opt/notebooks/shielding_files_20241116T205756_3wkad6bg'
